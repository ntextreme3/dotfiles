# ---------------------------------------
# General Configuration
# ---------------------------------------

# R to reload the tmux config
unbind r
bind r source-file ~/.tmux.conf \; display-message "Config reloaded..."

# Set 'C-a' as the default prefix, similar to screen
set -g prefix C-a
unbind C-b
bind C-a send-prefix

# Increase scrollback history limit for more lines
set -g history-limit 30000

# ---------------------------------------
# Terminal and Mouse Configuration
# ---------------------------------------

# Set terminal to 256-color mode for better color support
set -g default-terminal "screen-256color"

# Disable mouse support (set to 'on' if you prefer mouse control)
set -g mouse off

# ---------------------------------------
# Pane and Window Configuration
# ---------------------------------------

# Bind splits to use the current path in new panes
bind '"' split-window -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"

# ---------------------------------------
# Color Configuration
# ---------------------------------------

# Colorize messages in the command line
set-option -g message-style "bg=black,fg=brightred"

# ---------------------------------------
# Status Bar Configuration
# ---------------------------------------

# Enable status bar and set update frequency
set-option -g status on                # Enable status bar
set -g status-interval 3               # Set status update interval (default is 15 seconds)
set -g status-justify left             # Align window list to the left

# Visual notifications for activity in other windows
setw -g monitor-activity on
set -g visual-activity on

# Set colors for the status bar
set-option -g status-style "fg=white,bg=colour237,dim"

# Inactive window list colors (applies to all windows except the active one)
set-window-option -g window-status-style "fg=colour202,bg=colour237,dim"

# Active window list colors (applies to the currently selected window)
set-window-option -g window-status-current-style "fg=white,bg=colour202,bright,bold"

# Set vi-style key bindings for copy-mode, search, etc.
set-window-option -g mode-keys vi

# ---------------------------------------
# Plugin Management (tmux-plugins/tpm)
# ---------------------------------------

# First, need to install tmux plugin manager (TPM). This should be handled by
# chezmoi, but if not:
#     git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm

# List of plugins - After updating this list, use 'prefix + I' to install plugins
set -g @plugin 'tmux-plugins/tmux-sensible'       # Basic sensible defaults
set -g @plugin 'tmux-plugins/tmux-resurrect'      # Auto-save and restore tmux session
set -g @plugin 'tmux-plugins/tmux-continuum'      # Continuous tmux session saving

# Activate automatic restoration of tmux environment
set -g @continuum-restore 'on'

# Example: To install other plugins
# set -g @plugin 'github_username/plugin_name'
# set -g @plugin 'git@github.com/user/plugin'
# set -g @plugin 'git@bitbucket.com/user/plugin'

# Allow selecting which resurrect state to restore
bind-key 'M' popup -E "bash ~/.local/bin/tmux-resurrect-fzf.sh"

# Initialize TPM (make sure this is at the very bottom)
run -b '~/.tmux/plugins/tpm/tpm'

