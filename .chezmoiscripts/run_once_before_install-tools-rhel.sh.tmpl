{{ if eq .osid "linux-rhel" -}}

#!/bin/bash
set -euo pipefail

# Use sudo if it exists
SUDO=""
if command -v sudo &> /dev/null; then
    SUDO="sudo"
fi

# Enable EPEL repository for additional packages
$SUDO yum install -y epel-release

# install dependencies
$SUDO yum install -y cmake bash-completion

# install tools with yum
$SUDO yum install -y curl git tmux ripgrep jq tree net-tools golang bat fd-find

# install rustup (for latest rust - yum rust package is often outdated)
if ! command -v rustup &> /dev/null; then
    curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y --no-modify-path
    source "$HOME/.cargo/env"
fi

# update rust to latest
rustup update stable
rustup default stable

# install tools with cargo
cargo install --locked git-delta

# starship takes a long time with cargo, so:
if ! command -v starship &> /dev/null; then
    curl -sS https://starship.rs/install.sh | sh -s -- -y
fi

# install tools with go
go install github.com/junegunn/fzf@latest

# NOTE: Skipping kubectl, kubectx, yq, jqp for now.

{{ end -}}
